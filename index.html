<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Packing List Generator</title>
    <link href="./output.css" rel="stylesheet">
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .checkbox-container:hover .checkmark {
            border-color: #dc2626;
        }

        .checkbox-container input:checked~.checkmark {
            background-color: #dc2626;
            border-color: #dc2626;
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .checkbox-container input:checked~.checkmark:after {
            display: block;
        }

        .checkbox-container .checkmark:after {
            left: 7px;
            top: 3px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        @media (max-width: 768px) {
            .grid-cols-2 {
                grid-template-columns: repeat(1, 1fr);
            }

            .trip-details {
                order: 2;
            }

            .packing-list {
                order: 1;
                margin-bottom: 1.5rem;
            }
        }

        .category-header {
            background-color: #fee2e2;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .custom-item-form {
            background-color: #f9fafb;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1.5rem;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <header class="text-center mb-10 relative">
            <h1 class="text-4xl font-bold bg-gradient-to-r from-red-600 to-red-800 bg-clip-text text-transparent mb-2">
                üß≥ Smart Packing List</h1>
            <p class="text-gray-600">‚ú® Generate your perfect packing list based on your trip details ‚ú®</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Trip Details Form -->
            <div class="bg-white p-6 rounded-xl shadow-md lg:col-span-1">
                <h2 class="text-xl font-semibold text-red-700 mb-4 border-b-2 border-red-100 pb-2">‚úàÔ∏è Trip Details</h2>

                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" id="nightsLabel">Number of
                            Nights</label>
                        <input type="number" id="nights" min="1" value="3"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" id="weatherLabel">Weather</label>
                        <select id="weather"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                            <option value="warm">‚òÄÔ∏è Warm</option>
                            <option value="medium" selected>üå§Ô∏è Medium</option>
                            <option value="cold">‚ùÑÔ∏è Cold</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1"
                            id="accommodationLabel">Accommodation Type</label>
                        <select id="accommodation"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                            <option value="hotel">Hotel</option>
                            <option value="hostel">Hostel</option>
                            <option value="mountain_cabin">Mountain Cabin</option>
                            <option value="holiday_home">Holiday Home</option>
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="beach" class="rounded text-red-600 focus:ring-red-500">
                                <span class="text-sm text-gray-700">Beach</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="sauna" class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Sauna</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="hiking"
                                    class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Hiking</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="climbing"
                                    class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Climbing</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="abroad"
                                    class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Abroad</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="flight"
                                    class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Flight</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="fotos" class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Photos</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="washing_machine"
                                    class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm text-gray-700">Washing Machine Available</span>
                            </label>
                        </div>
                    </div>

                    <button id="generateBtn"
                        class="w-full bg-gradient-to-r from-red-600 to-red-800 text-white py-3 px-4 rounded-lg hover:from-red-700 hover:to-red-900 transition duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 shadow-md">
                        ‚ú® Generate Packing List ‚ú®
                    </button>
                </div>
            </div>

            <!-- Packing List -->
            <div class="bg-white p-6 rounded-xl shadow-md lg:col-span-2 packing-list">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-red-700 border-b-2 border-red-100 pb-2">üìã Your Packing List
                    </h2>
                    <div class="text-sm text-gray-500">
                        <span id="packedCount">0</span> <span id="packedStatusText">of</span> <span
                            id="totalCount">0</span> <span id="packedText">packed</span>
                    </div>
                </div>

                <div id="packingList" class="space-y-3">
                    <div class="text-center py-10 text-gray-400">
                        <i class="fas fa-suitcase text-4xl mb-2 text-indigo-300"></i>
                        <p class="text-indigo-400">Enter your trip details and generate your packing list ‚ú®</p>
                    </div>
                </div>

                <div id="progressBar" class="mt-6 hidden">
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progressFill" class="bg-red-600 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let currentItems = [];
            const generateBtn = document.getElementById('generateBtn');
            const packingList = document.getElementById('packingList');
            const packedCount = document.getElementById('packedCount');
            const totalCount = document.getElementById('totalCount');
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');

            // Load saved state if it exists
            function loadSavedState() {
                const savedState = sessionStorage.getItem('packingListState');
                if (savedState) {
                    try {
                        const state = JSON.parse(savedState);

                        // Restore form inputs
                        if (state.formData) {
                            if (state.formData.nights) document.getElementById('nights').value = state.formData.nights;
                            if (state.formData.weather) document.getElementById('weather').value = state.formData.weather;
                            if (state.formData.accommodation) document.getElementById('accommodation').value = state.formData.accommodation;

                            const checkboxes = ['beach', 'sauna', 'hiking', 'climbing', 'abroad', 'flight', 'fotos', 'washing_machine'];
                            checkboxes.forEach(id => {
                                if (state.formData[id] !== undefined) {
                                    document.getElementById(id).checked = state.formData[id];
                                }
                            });
                        }

                        // Restore items and checked state if available
                        if (state.items && state.items.length > 0) {
                            currentItems = state.items;
                            displayPackingList(currentItems);

                            // Restore checked state after a small delay to allow DOM to update
                            setTimeout(() => {
                                if (state.checkedItems) {
                                    state.checkedItems.forEach((isChecked, index) => {
                                        const checkboxes = document.querySelectorAll('.checkbox-container input[type="checkbox"]');
                                        if (checkboxes[index]) {
                                            checkboxes[index].checked = isChecked;
                                            // Trigger change event to update UI
                                            const event = new Event('change');
                                            checkboxes[index].dispatchEvent(event);
                                        }
                                    });
                                }
                            }, 100);
                        }
                    } catch (e) {
                        console.error('Error loading saved state:', e);
                        sessionStorage.removeItem('packingListState');
                    }
                }
            }

            // Save current state to session storage
            function saveState() {
                const state = {
                    formData: {
                        nights: document.getElementById('nights').value,
                        weather: document.getElementById('weather').value,
                        accommodation: document.getElementById('accommodation').value,
                        beach: document.getElementById('beach').checked,
                        sauna: document.getElementById('sauna').checked,
                        hiking: document.getElementById('hiking').checked,
                        climbing: document.getElementById('climbing').checked,
                        abroad: document.getElementById('abroad').checked,
                        flight: document.getElementById('flight').checked,
                        fotos: document.getElementById('fotos').checked,
                        washing_machine: document.getElementById('washing_machine').checked
                    },
                    items: currentItems,
                    checkedItems: Array.from(document.querySelectorAll('.checkbox-container input[type="checkbox"]')).map(cb => cb.checked)
                };
                sessionStorage.setItem('packingListState', JSON.stringify(state));
            }

            // Add event listeners to form inputs to save state on change
            const formInputs = [
                'nights', 'weather', 'accommodation', 'beach', 'sauna',
                'hiking', 'climbing', 'abroad', 'flight', 'fotos', 'washing_machine'
            ];

            formInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', saveState);
                }
            });

            // Load saved state when page loads
            loadSavedState();

            generateBtn.addEventListener('click', function() {
                generatePackingList();
                saveState(); // Save state after generating new list
            });
            function generatePackingList() {
                console.log('Generate button clicked'); // Debug log
                // Get form values
                const nights = parseInt(document.getElementById('nights').value) || 3;
                const weather = document.getElementById('weather').value;
                const beach = document.getElementById('beach').checked;
                const sauna = document.getElementById('sauna').checked;
                const hiking = document.getElementById('hiking').checked;
                const climbing = document.getElementById('climbing').checked;
                const abroad = document.getElementById('abroad').checked;
                const flight = document.getElementById('flight').checked;
                const fotos = document.getElementById('fotos').checked;
                const accommodation = document.getElementById('accommodation').value;
                const washing_machine = document.getElementById('washing_machine').checked;

                // Generate packing list based on parameters
                let items = [];

                // Helper function to add item with duplicate check
                function addItem(name, quantity, category) {
                    // Check if item already exists (case-insensitive)
                    const existingItem = items.find(item =>
                        item.name.toLowerCase() === name.toLowerCase()
                    );

                    if (!existingItem) {
                        items.push({ name, quantity, category });
                    }
                    // Could optionally merge quantities here if desired
                }

                // Clothing basics - adjust quantities based on washing machine availability
                if (washing_machine) {
                    const shirtsQty = Math.min(7, Math.ceil(nights));
                    const underpantsQty = Math.min(7, Math.ceil(nights));
                    const socksQty = Math.min(7, Math.ceil(nights));
                    addItem(shirtsQty === 1 ? 'Shirt' : 'Shirts', shirtsQty, 'clothing');
                    addItem('Detergent', 1, 'clothing');
                    addItem(underpantsQty === 1 ? 'Underpant' : 'Underpants', underpantsQty, 'clothing');
                    addItem(socksQty === 1 ? 'Sock pair' : 'Sock pairs', socksQty, 'clothing');
                } else {
                    addItem(nights === 1 ? 'Shirt' : 'Shirts', nights, 'clothing');
                    addItem(nights === 1 ? 'Underpant' : 'Underpants', nights, 'clothing');
                    addItem(nights === 1 ? 'Sock pair' : 'Sock pairs', nights, 'clothing');
                }

                if (weather === 'warm') {
                    addItem('Sunscreen', 1, 'personal');
                    addItem('Sunglasses', 1, 'personal');
                    if (washing_machine) {
                        const vestsQty = Math.min(2, Math.ceil(nights / 10));
                        const shortsQty = Math.min(2, Math.ceil(nights / 5));
                        addItem(vestsQty === 1 ? 'Vest' : 'Vests', vestsQty, 'clothing');
                        addItem(shortsQty === 1 ? 'Pair of shorts' : 'Pairs of shorts', shortsQty, 'clothing');
                    } else {
                        const vestsQty = Math.ceil(nights / 10);
                        const shortsQty = Math.ceil(nights / 5);
                        addItem(vestsQty === 1 ? 'Vest' : 'Vests', vestsQty, 'clothing');
                        addItem(shortsQty === 1 ? 'Pair of shorts' : 'Pairs of shorts', shortsQty, 'clothing');
                    }
                } else if (weather === 'medium') {
                    addItem('Jacket', 1, 'clothing');
                    if (washing_machine) {
                        const vestsQty = Math.min(2, Math.ceil(nights / 5));
                        const shortsQty = Math.min(2, Math.ceil(nights / 5));
                        const pantsQty = Math.min(2, Math.ceil(nights / 5));
                        addItem(vestsQty === 1 ? 'Vest' : 'Vests', vestsQty, 'clothing');
                        addItem(shortsQty === 1 ? 'Pair of shorts' : 'Pairs of shorts', shortsQty, 'clothing');
                        addItem(pantsQty === 1 ? 'Pair of pants' : 'Pairs of pants', pantsQty, 'clothing');
                    } else {
                        const qty = Math.ceil(nights / 5);
                        addItem(qty === 1 ? 'Vest' : 'Vests', qty, 'clothing');
                        addItem(qty === 1 ? 'Pair of shorts' : 'Pairs of shorts', qty, 'clothing');
                        addItem(qty === 1 ? 'Pair of pants' : 'Pairs of pants', qty, 'clothing');
                    }
                } else if (weather === 'cold') {
                    addItem('Jacket', 1, 'clothing');
                    addItem('Pair of gloves', 1, 'clothing');
                    addItem('Hat', 1, 'clothing');
                    if (washing_machine) {
                        const vestsQty = Math.min(2, Math.ceil(nights / 5));
                        const pantsQty = Math.min(2, Math.ceil(nights / 5));
                        addItem(vestsQty === 1 ? 'Vest' : 'Vests', vestsQty, 'clothing');
                        addItem(pantsQty === 1 ? 'Pair of pants' : 'Pairs of pants', pantsQty, 'clothing');
                    } else {
                        const qty = Math.ceil(nights / 5);
                        addItem(qty === 1 ? 'Vest' : 'Vests', qty, 'clothing');
                        addItem(qty === 1 ? 'Pair of pants' : 'Pairs of pants', qty, 'clothing');
                    }
                }

                if (nights > 5) {
                    addItem('Additional pair of shoes', 1, 'clothing')
                }

                // Beach items
                if (beach) {
                    addItem('Swimsuit', 1, 'beach');
                    addItem('Pair of flip flops', 1, 'beach');
                    addItem('Beach towel', 1, 'beach');
                    addItem('Sun hat', 1, 'beach');
                }

                // Sauna items
                if (sauna) {
                    addItem('Swimsuit', 1, 'beach');
                    addItem('Sauna towel', 1, 'sauna');
                    addItem('Bathrobe', 1, 'sauna');
                    addItem('Slippers', 1, '');
                    addItem('Sauna hat', 1, 'sauna');
                }

                // Hiking items
                if (hiking) {
                    addItem('Pair of hiking boots', 1, 'hiking');
                    addItem('Pair of hiking pants', 1, 'hiking');
                    addItem('Pair of hiking socks', 2, 'hiking');
                    addItem('Hiking stick', 2, 'hiking');
                    addItem('Backpack', 1, 'hiking');
                    addItem('Water bag', 1, 'hiking');
                    addItem('Hat', 1, 'clothing');
                    addItem('Headlamp', 1, 'clothing');
                    if (weather === 'medium') {
                        addItem('Sunscreen', 1, 'personal');
                        addItem('Sunglasses', 1, 'personal');
                    }
                }

                // Climbing items
                if (climbing) {
                    addItem('Pair of climbing shoes', 1, 'climbing');
                    addItem('Via ferrata set', 1, 'climbing');
                    addItem('Carabiner', 1, 'climbing');
                    addItem('Climbing Harness', 1, 'climbing');
                    addItem('Helmet', 1, 'climbing');
                }

                // Electronics
                addItem('Phone', 1, 'electronics');
                addItem('Phone charger', 1, 'electronics');
                addItem('Notebook', 1, 'electronics');
                addItem('Notebook charger', 1, 'electronics');
                addItem('Headphones', 1, 'electronics');
                addItem('Power bank', 1, 'electronics');
                addItem('Steam Deck', 1, 'electronics');
                addItem('USB-C Adaptor', 1, 'electronics');
                addItem('HDMI Cable', 1, 'electronics');

                if (fotos) {
                    addItem('Camera', 1, 'electronics');
                    addItem('Camera charger', 1, 'electronics');
                }

                // Travel essentials
                if (abroad) {
                    addItem('Passport', 1, 'travel');
                    addItem('Travel adapter', 1, 'travel');
                }

                if (flight) {
                    addItem('Neck pillow', 1, 'travel');
                    addItem('Pair of earplugs', 1, 'accommodation');
                }

                // Accommodation items
                const accommodationType = document.getElementById('accommodation').value;

                if (accommodationType === 'hostel') {
                    addItem('Padlock', 1, 'accommodation');
                    addItem('Pair of earplugs', 1, 'accommodation');
                    addItem('Slippers', 1, 'personal');
                    addItem('Towels', 1, 'accommodation');
                } else if (accommodationType === 'mountain_cabin') {
                    addItem('Sleeping bag', 1, 'accommodation');
                    addItem('Towel', 1, 'accommodation');
                } else if (accommodationType === 'holiday_home') {
                    addItem('Aeropress', 1, 'accommodation');
                    addItem('Knife', 1, 'accommodation');
                    addItem('Spicery', 1, 'accommodation');
                }

                // Personal care
                addItem('Toothbrush', 1, 'personal');
                addItem('Toothpaste', 1, 'personal');
                addItem('Shower Gel', 1, 'personal');
                addItem('Deodorant', 1, 'personal');
                addItem('Comb/Brush', 1, 'personal');
                addItem('Night Guard', 1, 'personal');
                if (nights > 3) {
                    addItem('Shaver', 1, 'personal');
                }
                if (nights > 7) {
                    addItem('Nail Clipper', 1, 'personal');
                }

                // Miscellaneous
                addItem('Cash', 1, 'misc');
                addItem('Water Bottle', 1, 'misc');
                addItem('Driver\'s license', 1, 'misc');
                addItem('Painkillers', 1, 'misc');
                addItem('Band Aid', 1, 'misc');
                addItem('Disinfectant', 1, 'misc');
                addItem('Chewing gum', 1, 'misc');
                addItem('Books/E-Reader', 1, 'misc');
                addItem('Washing bag', 1, 'clothing');
                addItem('Condoms', 1, 'misc');

                console.log('Generated items:', items); // Debug log
                // Display the packing list
                displayPackingList(items);
            }

            function displayPackingList(items) {
                currentItems = items; // Store the current items
                packingList.innerHTML = '';
                totalCount.textContent = items.length;
                packedCount.textContent = '0';
                progressBar.classList.remove('hidden');
                progressFill.style.width = '0%';

                // Group items by category
                const categories = {};
                items.forEach(item => {
                    if (!categories[item.category]) {
                        categories[item.category] = [];
                    }
                    categories[item.category].push(item);
                });

                // Display items by category
                for (const category in categories) {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'mb-6 fade-in';

                    const categoryTitle = document.createElement('div');
                    categoryTitle.className = 'mb-3';

                    const titleRow = document.createElement('div');
                    titleRow.className = 'flex items-center justify-between mb-1';
                    titleRow.innerHTML = `
                        <h3 class="text-lg font-medium text-indigo-700 capitalize">${category}</h3>
                        <span class="text-sm font-normal text-gray-500">0/${categories[category].length}</span>
                    `;

                    const progressBar = document.createElement('div');
                    progressBar.className = 'w-full bg-gray-200 rounded-full h-1.5 mb-1';
                    progressBar.innerHTML = `
                        <div class="bg-indigo-600 h-1.5 rounded-full category-progress" style="width: 0%" data-category="${category}"></div>
                    `;

                    categoryDiv.appendChild(titleRow);
                    categoryDiv.appendChild(progressBar);

                    const itemsList = document.createElement('div');
                    itemsList.className = 'space-y-2';

                    categories[category].forEach((item, index) => {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                        itemDiv.dataset.category = category;

                        const label = document.createElement('label');
                        label.className = 'checkbox-container flex items-center space-x-3 cursor-pointer';

                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.className = 'opacity-0 absolute';
                        checkbox.addEventListener('change', updatePackedCount);

                        const checkmark = document.createElement('span');
                        checkmark.className = 'checkmark w-5 h-5 border border-gray-300 rounded-md bg-white flex-shrink-0';

                        const itemText = document.createElement('span');
                        itemText.className = 'text-gray-700';
                        itemText.textContent = `${item.name}${item.quantity > 1 ? ` (${item.quantity})` : ''}`;

                        label.appendChild(checkbox);
                        label.appendChild(checkmark);
                        label.appendChild(itemText);

                        itemDiv.appendChild(label);
                        itemsList.appendChild(itemDiv);
                    });

                    categoryDiv.appendChild(itemsList);
                    packingList.appendChild(categoryDiv);
                }
            }

            function updatePackedCount() {
                const checkboxes = document.querySelectorAll('.checkbox-container input[type="checkbox"]');
                const checkedCount = Array.from(checkboxes).filter(checkbox => checkbox.checked).length;
                const total = checkboxes.length;

                packedCount.textContent = checkedCount;
                totalCount.textContent = total;

                // Update progress bar
                const progress = total > 0 ? Math.round((checkedCount / total) * 100) : 0;
                progressFill.style.width = `${progress}%`;

                // Update category progress
                const categoryItems = {};
                document.querySelectorAll('.checkbox-container input[type="checkbox"]').forEach((checkbox) => {
                    const category = checkbox.closest('[data-category]')?.dataset.category || 'uncategorized';
                    if (!categoryItems[category]) {
                        categoryItems[category] = { total: 0, checked: 0 };
                    }
                    categoryItems[category].total++;
                    if (checkbox.checked) {
                        categoryItems[category].checked++;
                    }
                });

                // Update each category's progress
                Object.entries(categoryItems).forEach(([category, { total, checked }]) => {
                    const progress = Math.round((checked / total) * 100);
                    const progressElement = document.querySelector(`.category-progress[data-category="${category}"]`);

                    if (progressElement) {
                        progressElement.style.width = `${progress}%`;

                        // Update category count
                        const countElement = progressElement.closest('.mb-6')?.querySelector('.text-sm');
                        if (countElement) {
                            countElement.textContent = `${checked}/${total}`;
                        }

                        // Update progress bar color based on completion
                        if (progress === 100) {
                            progressElement.classList.remove('bg-indigo-600');
                            progressElement.classList.add('bg-green-500');
                        } else {
                            progressElement.classList.remove('bg-green-500');
                            progressElement.classList.add('bg-indigo-600');
                        }
                    }
                });

                // Save the updated state
                saveState();
            }
        });
    </script>
</body>

</html>
